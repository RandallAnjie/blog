<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">


<link rel="stylesheet" href="/blog/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"zhuanjier.github.io","root":"/blog/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="转接的博客">
<meta property="og:url" content="https://zhuanjier.github.io/blog/page/5/index.html">
<meta property="og:site_name" content="转接的博客">
<meta property="og:locale">
<meta property="article:author" content="转接">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://zhuanjier.github.io/blog/page/5/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh'
  };
</script>

  <title>转接的博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Navigationsleiste an/ausschalten">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">转接的博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/blog/" rel="section"><i class="fa fa-home fa-fw"></i>Startseite</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archiv</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="https://zhuanjier.github.io/blog/2022/02/13/wp-global-styles-twentyseventeen/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="转接">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="转接的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2022/02/13/wp-global-styles-twentyseventeen/" class="post-title-link" itemprop="url">Custom Styles</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Veröffentlicht am</span>

              <time title="Erstellt: 2022-02-13 17:51:55" itemprop="dateCreated datePublished" datetime="2022-02-13T17:51:55+08:00">2022-02-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Bearbeitet am</span>
                <time title="Geändert am: 2022-07-10 14:37:47" itemprop="dateModified" datetime="2022-07-10T14:37:47+08:00">2022-07-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">in</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/uncategorized/" itemprop="url" rel="index"><span itemprop="name">uncategorized</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>{“version”: 2, “isGlobalStylesUserThemeJSON”: true }</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="https://zhuanjier.github.io/blog/2022/01/15/monotone-stack/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="转接">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="转接的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2022/01/15/monotone-stack/" class="post-title-link" itemprop="url">单调栈的解释及应用</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Veröffentlicht am</span>

              <time title="Erstellt: 2022-01-15 01:43:03" itemprop="dateCreated datePublished" datetime="2022-01-15T01:43:03+08:00">2022-01-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Bearbeitet am</span>
                <time title="Geändert am: 2022-07-10 14:37:47" itemprop="dateModified" datetime="2022-07-10T14:37:47+08:00">2022-07-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">in</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">算法</span></a>
                </span>
                  . 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/JAVA/" itemprop="url" rel="index"><span itemprop="name">JAVA</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="单调栈定义"><a href="#单调栈定义" class="headerlink" title="单调栈定义"></a>单调栈定义</h2><p>从名字上就听的出来，单调栈中存放的数据应该是有序的，所以单调栈也分为单调递增栈和单调递减栈</p>
<p>单调递增栈：单调递增栈就是从栈底到栈顶数据是从大到小<br>单调递减栈：单调递减栈就是从栈底到栈顶数据是从小到大</p>
<p>参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/lucky52529/article/details/89155694">[数据结构]——单调栈_lucky52529的博客-CSDN博客_单调递增栈</a></p>
<h2 id="定义简例"><a href="#定义简例" class="headerlink" title="定义简例"></a>定义简例</h2><p>假如有一个单调栈（单调递增）现有以下数字：7，3，5，6，10</p>
<ul>
<li>7入栈时（栈空），7入栈，栈内：7</li>
<li>3入栈时（3比7小），3入栈，栈内：7，3</li>
<li>5入栈时（5比3大，比7小），3弹栈，5入栈，栈内：7，5</li>
<li>6入栈时（6比5大，比7小），5弹栈，6入栈，栈内：7，6</li>
<li>10入栈时（10比6大，比7大），6弹栈，7弹栈，栈内：10</li>
</ul>
<h2 id="伪代码"><a href="#伪代码" class="headerlink" title="伪代码"></a>伪代码</h2><p>定义数组或者栈;<br>for (遍历原始数据数组)<br>{<br>if (栈空  栈顶元素大于等于当前比较元素)<br>{<br>入栈;<br>}<br>else<br>{<br>while (栈不为空 &amp;&amp; 栈顶元素小于当前元素)<br>{<br>栈顶元素出栈;<br>更新结果;<br>}<br>当前数据入栈;<br>}<br>}</p>
<h2 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><ul>
<li>小Q在周末的时候和他的小伙伴来到大城市逛街，一条步行街上有很多高楼，共有n座高楼排成一行。小Q从第一栋一直走到了最后一栋，小Q从来都没有见到这么多的楼，所以他想知道他在每栋楼的位置处能看到多少栋楼呢？（当前面的楼的高度大于等于后面的楼时，后面的楼将被挡住）</li>
</ul>
<h3 id="输入样例"><a href="#输入样例" class="headerlink" title="输入样例"></a>输入样例</h3><ul>
<li>[5,3,8,3,2,5]</li>
</ul>
<h3 id="输出样例"><a href="#输出样例" class="headerlink" title="输出样例"></a>输出样例</h3><ul>
<li>[3,3,5,4,4,4]</li>
</ul>
<h3 id="样例说明"><a href="#样例说明" class="headerlink" title="样例说明"></a>样例说明</h3><ul>
<li>当小Q处于位置3时，他可以向前看到位置2,1处的楼，向后看到位置4,6处的楼，加上第3栋楼，共可看到5栋楼。当小Q处于位置4时，他可以向前看到位置3处的楼，向后看到位置5,6处的楼，加上第4栋楼，共可看到4栋楼。</li>
</ul>
<h3 id="函数代码（利用动态数组ArrayList模拟栈）"><a href="#函数代码（利用动态数组ArrayList模拟栈）" class="headerlink" title="函数代码（利用动态数组ArrayList模拟栈）"></a>函数代码（利用动态数组ArrayList模拟栈）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">public static int[] findBuilding (int[] heights) &#123;</span><br><span class="line">int[] number = new int[heights.length];</span><br><span class="line">ArrayList&lt;Integer&gt; LTR = new ArrayList&lt;Integer&gt;(); // 从大到小（从左往右从大到小）</span><br><span class="line">ArrayList&lt;Integer&gt; RTL = new ArrayList&lt;Integer&gt;(); // 从小到大（从右往左从大到小）</span><br><span class="line">for (int i = 0, j = number.length-1; i &lt; number.length; i++,j--) &#123;</span><br><span class="line">// 每次i，j游标指向的是小Q所在的房子的左边的房子或者右边的房子在内的单调栈</span><br><span class="line">// 因为第一次循环的时候是最左边的房子和最右边的房子入栈，所以要先记录左右两边单调栈里的数</span><br><span class="line">// 且最后一次循环不出现问题，LYT单调栈到最右边的时候即不出现最右边的房子为某个房子左边的房子，RTL同理</span><br><span class="line">number[i] += LTR.size();</span><br><span class="line">number[j] += RTL.size();</span><br><span class="line">while (LTR.size()&gt;0 &amp;&amp; heights[i]&gt;(int)LTR.get(LTR.size()-1)) &#123;</span><br><span class="line">LTR.remove(LTR.size()-1); // LTR出栈</span><br><span class="line">&#125;</span><br><span class="line">while (RTL.size()&gt;0 &amp;&amp; heights[j]&gt;(int)RTL.get(RTL.size()-1)) &#123;</span><br><span class="line">RTL.remove(RTL.size()-1); // RT出栈</span><br><span class="line">&#125;</span><br><span class="line">LTR.add(heights[i]); // LTR入栈</span><br><span class="line">RTL.add(heights[j]); // RTL入栈</span><br><span class="line">&#125;</span><br><span class="line">for (int i = 0; i &lt; number.length; i++) &#123;</span><br><span class="line">number[i] ++;</span><br><span class="line">&#125;</span><br><span class="line">return number;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="更换栈类型函数代码为"><a href="#更换栈类型函数代码为" class="headerlink" title="更换栈类型函数代码为"></a>更换栈类型函数代码为</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">public static int[] findBuilding (int[] heights) &#123;</span><br><span class="line">int[] number = new int[heights.length];</span><br><span class="line">Stack&lt;Integer&gt; LTR = new Stack&lt;&gt;(); // 从大到小（从左往右从大到小）</span><br><span class="line">Stack&lt;Integer&gt; RTL = new Stack&lt;&gt;(); // 从小到大（从右往左从大到小）</span><br><span class="line">for (int i = 0, j = number.length-1; i &lt; number.length; i++,j--) &#123;</span><br><span class="line">// 每次i，j游标指向的是小Q所在的房子的左边的房子或者右边的房子在内的单调栈</span><br><span class="line">// 因为第一次循环的时候是最左边的房子和最右边的房子入栈，所以要先记录左右两边单调栈里的数</span><br><span class="line">// 且最后一次循环不出现问题，LYT单调栈到最右边的时候即不出现最右边的房子为某个房子左边的房子，RTL同理</span><br><span class="line">number[i] += LTR.size();</span><br><span class="line">number[j] += RTL.size();</span><br><span class="line">while (!LTR.isEmpty() &amp;&amp; heights[i]&gt;LTR.peek()) &#123;</span><br><span class="line">LTR.pop(); // LTR出栈</span><br><span class="line">&#125;</span><br><span class="line">while (!RTL.isEmpty() &amp;&amp; heights[j]&gt;RTL.peek()) &#123;</span><br><span class="line">RTL.pop(); // RT出栈</span><br><span class="line">&#125;</span><br><span class="line">LTR.push(heights[i]); // LTR入栈</span><br><span class="line">RTL.push(heights[j]); // RTL入栈</span><br><span class="line">&#125;</span><br><span class="line">for (int i = 0; i &lt; number.length; i++) &#123;</span><br><span class="line">number[i] ++;</span><br><span class="line">&#125;</span><br><span class="line">return number;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="灵感来源"><a href="#灵感来源" class="headerlink" title="灵感来源"></a>灵感来源</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">  </span><br><span class="line">int main() &#123;</span><br><span class="line">    int i,n,j, x[100001],LtoR[100001],RtoL[100001],sum[100001];</span><br><span class="line">    scanf(&quot;%d&quot;,&amp;n);</span><br><span class="line">    for(i=0;i&lt;n;i++)</span><br><span class="line">    scanf(&quot;%d&quot;,&amp;x[i]);</span><br><span class="line">    int indl=0,indr=0;</span><br><span class="line">    for(i=0,j=n-1;i&lt;n,j&gt;=0;i++,j--)&#123;</span><br><span class="line">    sum[i]+=indl;</span><br><span class="line">    sum[n-i-1]+=indr;</span><br><span class="line">//从左往右遍历（从右往左看）</span><br><span class="line">    while(LtoR[indl-1]&lt;=x[i]&amp;&amp;indl&gt;0)&#123;</span><br><span class="line">    indl --;//出栈操作</span><br><span class="line">&#125;</span><br><span class="line">//从右往左遍历（从左往右看）</span><br><span class="line">while(RtoL[indr-1]&lt;=x[j]&amp;&amp;indr&gt;0)&#123;</span><br><span class="line">    indr --;//出栈操作</span><br><span class="line">&#125;</span><br><span class="line">    LtoR[indl]=x[i];//入栈</span><br><span class="line">    indl ++;</span><br><span class="line">    RtoL[indr]=x[j];//入栈</span><br><span class="line">    indr ++;</span><br><span class="line">&#125;</span><br><span class="line">//注意加一</span><br><span class="line">for(i=0;i&lt;n-1;i++)</span><br><span class="line">printf(&quot;%d &quot;,sum[i]+1);</span><br><span class="line">printf(&quot;%d\n&quot;,sum[n-1]+1);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Twinkle_sone/article/details/104593171">逛街【 腾讯2020校园招聘-后台&amp;综合-第一次笔试】（单调栈的应用）_Twinkle_sone的博客-CSDN博客</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="https://zhuanjier.github.io/blog/2021/12/31/computer-net-udp-server/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="转接">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="转接的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2021/12/31/computer-net-udp-server/" class="post-title-link" itemprop="url">计算机网络小学期——UDP服务器的设计</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Veröffentlicht am</span>

              <time title="Erstellt: 2021-12-31 19:51:43" itemprop="dateCreated datePublished" datetime="2021-12-31T19:51:43+08:00">2021-12-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Bearbeitet am</span>
                <time title="Geändert am: 2022-07-10 14:37:47" itemprop="dateModified" datetime="2022-07-10T14:37:47+08:00">2022-07-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">in</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
                  . 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" itemprop="url" rel="index"><span itemprop="name">计算机网络</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>成品下载链接：<a target="_blank" rel="noopener" href="http://gitlab.zhuanjie.ltd/Randall/udp-server/-/releases">发布 · Randall Chu &#x2F; UDP服务器的设计 · GitLab (gitlab.zhuanjie.ltd)</a></p>
<h2 id="要求"><a href="#要求" class="headerlink" title="要求"></a>要求</h2><p>UDP是TCP&#x2F;IP协议族为传输层设计的两个协议之一，是一种无连接的，不可靠的协议。由于UDP采取了无连接的方式，因此协议简单，在一些特定的应用中协议运行效率高。UDP适合一些实时的应用，如IP电话、视频会议，它们要求源主机以恒定的速率发送数据，并且在网络出现拥塞时，可以丢失一些数据，但是延迟不能太大。基于这些特点，流式多媒体通信、多播等应用在传输层采用的就是UDP协议。编写一UDP服务器程序，流畅地完成视频文件地传输，要能对多个客户端进行管理。需要通过UDP模拟多个客户端连接验证的情况。</p>
<h2 id="设计思路"><a href="#设计思路" class="headerlink" title="设计思路"></a>设计思路</h2><h3 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h3><p>a) 编译环境：Python3.10<br>b) 编译工具：PyCharm<br>c) 打包工具：pyinstaller</p>
<h3 id="调用函数库"><a href="#调用函数库" class="headerlink" title="调用函数库"></a>调用函数库</h3><p>a) time：处理时间的标准库，提供获取系统时间并格式化输出功能<br>b) socket：帮助在网络上的两个程序之间建立信息通道<br>c) queue：提供队列操作的模块，用于多个线程之间的数据共享<br>d) basename：去掉目录路径，单独返回文件名</p>
<h3 id="解决问题思路"><a href="#解决问题思路" class="headerlink" title="解决问题思路"></a>解决问题思路</h3><p>本程序由于需要在网络上搭建UDP服务器来传输信息、文件，则必须要定义一个合适的确认连接以及检验文件完成性的功能。<br>以TCP传输模式为样例，本程序的服务器端和客户端采用了类似TCP的三次握手确认连接和四次挥手断开连接。<br>本程序采用类似FTP传输模式，利用6000端口来传送控制信息以及一些普通消息，利用7777端口来传输文件信息，利用7778端口来接收ack数据包确认信息。<br>服务器端主进程开启接受消息线程，该线程负责接受捕获到的6000端口的UDP数据包，并将判断数据是否为连接、断开等命令数据。<br>如接收到连接指令则将信息发送方的套接字保存创建新线程负责处理该线程发送来的信息并且创建新管道方便与之通信。<br>如果是断开连接命令，则在“四次挥手”结束后结束该套接字对应的线程，释放资源。如果是其他命令，则将命令存放到信息来的套接字对应的管道中。<br>管道另一头接受到信息后开始处理对应信息。处理不同套接字的消息的进程在从套接字中取到消息后开始执行程序。如果将信息通过默认命令消息处理函数处理后返回不同对应的信息，如果服务器需要执行聊天操作，则会创建新线程调用循环发送函数给该套接字发送消息。如果服务器需要执行发送文件操作则需等待客户机发送所需要的文件目录后创建两个新线程一个负责在7777端口发送文件，另一个是负责在7778端口接收确认包。<br>客户端程序只需要获取服务器ip后主动连接服务器。在服务器相应后显示连接成功。同时启动两个线程，一个负责发送数据包，另一个负责接收数据包并处理。<br>处理数据时，如果为传输文件确认数据包，则阻塞发送数据包的线程，并把需要的文件路径发送至服务器。然后通过对接收到服务器7777端口发送来的数据进行整理，返回给服务器7778端口确认包。全部确认后文件传输完成并唤醒发送数据进程。<br>如果发送的数据为exit（断开连接命令），将状态变量改变，使得发送和接受线程全部停止，主进程等待两个线程结束后结束运行。</p>
<h2 id="流程图"><a href="#流程图" class="headerlink" title="流程图"></a>流程图</h2><p><img src="http://blog.zhuanjie.ltd/wp-content/uploads/2021/12/image-745x1024.png"></p>
<p>服务器端流程图</p>
<p><img src="http://blog.zhuanjie.ltd/wp-content/uploads/2021/12/image-1-630x1024.png"></p>
<p>客户端流程图</p>
<h2 id="详细设计-利用Python代码实现"><a href="#详细设计-利用Python代码实现" class="headerlink" title="详细设计(利用Python代码实现)"></a>详细设计(利用Python代码实现)</h2><h3 id="函数列表"><a href="#函数列表" class="headerlink" title="函数列表"></a>函数列表</h3><p>函数名</p>
<p>参数</p>
<p>描述</p>
<p>sendto</p>
<p>传输文件名称,客户端套接字</p>
<p>用于传输文件</p>
<p>recv_ack</p>
<p>无</p>
<p>确认客户端返回的确认信息</p>
<p>sendOne</p>
<p>消息,发送到的客户机的套接字</p>
<p>整合发送一条udp消息到指定套接字</p>
<p>circlesend</p>
<p>发送到的客户机的套接字</p>
<p>循环发送消息到客户端（基于聊天功能）</p>
<p>getfire</p>
<p>文件路径,发送到的客户机的套接字</p>
<p>获取文件函数，用于启动发送文件进程和确认客户端返回的确认进程</p>
<p>mafun</p>
<p>消息,发送到的客户机的套接字</p>
<p>默认命令消息处理函数</p>
<p>diviceConnect</p>
<p>发送到的客户机的套接字</p>
<p>连接到服务器后的设备所启动线程调用的函数</p>
<p>receive</p>
<p>无</p>
<p>接受消息并将消息送到管道</p>
<p>服务器端函数列表</p>
<p>函数名</p>
<p>参数</p>
<p>描述</p>
<p>getFile</p>
<p>文件名</p>
<p>获取文件路径，名称</p>
<p>receive</p>
<p>无</p>
<p>接受消息</p>
<p>circlesend</p>
<p>无</p>
<p>发送消息</p>
<p>客户端函数列表</p>
<h2 id="主要函数代码"><a href="#主要函数代码" class="headerlink" title="主要函数代码"></a>主要函数代码</h2><h3 id="服务器端主要函数"><a href="#服务器端主要函数" class="headerlink" title="服务器端主要函数"></a>服务器端主要函数</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"># 文件传输 占用端口7777</span><br><span class="line"># 三级子进程（父进程：设备对应进程）</span><br><span class="line"># 变量：(传输文件名称,客户端套接字)</span><br><span class="line">def sendto(fn_path, addr):</span><br><span class="line">    # 读取文件全部内容</span><br><span class="line">    with open(fn_path, &#x27;rb&#x27;) as fp:</span><br><span class="line">        content = fp.read()</span><br><span class="line">    # 获取文件大小，做好分块传输的准备</span><br><span class="line">    fn_size = len(content)</span><br><span class="line">    for start in range(fn_size // BUFFER_SIZE + 1):</span><br><span class="line">        positions.append(start * BUFFER_SIZE)</span><br><span class="line">    # 设置事件，可以启动用来接收确认信息的线程了</span><br><span class="line">    e.set()</span><br><span class="line">    # 窗口套接字，设置发送缓冲区大小</span><br><span class="line">    sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</span><br><span class="line">    sock.setsockopt(socket.SOL_SOCKET, socket.SO_SNDBUF, BUFFER_SIZE)</span><br><span class="line">    # 发送文件数据，直到所有分块都收到确认，否则就不停地循环发送</span><br><span class="line">    while positions:</span><br><span class="line">        for pos in positions:</span><br><span class="line">            sock.sendto(f&#x27;&#123;pos&#125;_&#x27;.encode() + content[pos:pos + BUFFER_SIZE], (addr[0], 7777))</span><br><span class="line">        time.sleep(0.1)</span><br><span class="line">    # 通知，发送完成</span><br><span class="line">    while file_name:</span><br><span class="line">        sock.sendto(b&#x27;over_&#x27; + file_name[0], (addr[0], 7777))</span><br><span class="line">    # 关闭套接字</span><br><span class="line">    sock.close()</span><br><span class="line"># 确认客户端返回的确认信息 占用端口7778</span><br><span class="line"># 三级子进程（父进程：设备对应进程）</span><br><span class="line"># 变量：空</span><br><span class="line">def recv_ack():</span><br><span class="line">    # 创建套接字，绑定本地端口，用来接收对方的确认信息</span><br><span class="line">    sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</span><br><span class="line">    sock.bind((IP, 7778))</span><br><span class="line">    # 如果所有分块都确认过，就结束循环</span><br><span class="line">    while positions:</span><br><span class="line">        # 预期收到的确认包格式为1234_ack</span><br><span class="line">        data, _ = sock.recvfrom(1024)</span><br><span class="line">        pos = int(data.split(b&#x27;_&#x27;)[0])</span><br><span class="line">        if pos in positions:</span><br><span class="line">            positions.remove(pos)</span><br><span class="line">    # 确认对方收到文件名，并已接收全部数据</span><br><span class="line">    while file_name:</span><br><span class="line">        data, _ = sock.recvfrom(1024)</span><br><span class="line">        fn = data.split(b&#x27;_&#x27;)[0]</span><br><span class="line">        if fn in file_name:</span><br><span class="line">            file_name.remove(fn)</span><br><span class="line">    sock.close()</span><br><span class="line"># 整合发送一条udp消息</span><br><span class="line"># 变量：(消息,发送到的客户机的套接字)</span><br><span class="line">def sendOne(msg, addr):</span><br><span class="line">    s.sendto(msg.encode(), addr)</span><br><span class="line"># 循环发送消息到客户端（聊天功能）</span><br><span class="line"># 变量：(发送到的客户机的套接字)</span><br><span class="line">def circlesend(addr):</span><br><span class="line">    global OCCUIPED</span><br><span class="line">    while OCCUIPED:</span><br><span class="line">        send_data = input(&quot;To&quot; + str(addr) + &quot;:&quot;)</span><br><span class="line">        s.sendto(send_data.encode(), addr)</span><br><span class="line">        if send_data == &quot;exitchat&quot;:</span><br><span class="line">            OCCUIPED = False</span><br><span class="line">            break</span><br><span class="line"># 获取文件函数，用于启动发送文件进程和确认客户端返回的确认进程</span><br><span class="line"># 变量：(文件路径,发送到的客户机的套接字)</span><br><span class="line">def getfire(datapath, addr):</span><br><span class="line">    global fn_path, file_name</span><br><span class="line">    fn_path = datapath</span><br><span class="line">    file_name = [f&#x27;&#123;basename(fn_path)&#125;&#x27;.encode()]</span><br><span class="line">    t1 = threading.Thread(target=sendto, args=(fn_path, addr))</span><br><span class="line">    t1.start()</span><br><span class="line">    e.clear()</span><br><span class="line">    e.wait()</span><br><span class="line">    t2 = threading.Thread(target=recv_ack)</span><br><span class="line">    t2.start()</span><br><span class="line">    # 等待发送线程和接收确认线程都结束</span><br><span class="line">    t2.join()</span><br><span class="line">    t1.join()</span><br><span class="line"># 默认命令消息处理函数</span><br><span class="line"># 变量：(消息,发送到的客户机的套接字)</span><br><span class="line">def mafun(message, addr):</span><br><span class="line">    if message == &quot;help&quot;:</span><br><span class="line">        sendOne(&quot;\n1.返回当前服务器时间\n2.聊天\n3.文件传输\n4.关于\nexit——退出 help——帮助&quot;, addr)  # man——指令详情</span><br><span class="line">    elif message == &quot;1&quot;:</span><br><span class="line">        ticks = time.time()</span><br><span class="line">        sendOne(&quot;\n当前服务器时间戳为:&quot; + str(ticks) + &quot;\n当前服务器时间为&quot; + str(time.asctime(time.localtime(ticks))), addr)</span><br><span class="line">    elif message == &quot;2&quot;:</span><br><span class="line">        global OCCUIPED</span><br><span class="line">        if OCCUIPED != &quot;&quot;:</span><br><span class="line">            return &quot;聊天室搭建失败，聊天室被占用！&quot;</span><br><span class="line">        else:</span><br><span class="line">            OCCUIPED = str(addr)</span><br><span class="line">            tsend = threading.Thread(target=circlesend, args=(addr,))  # 开启发送消息线程</span><br><span class="line">            tsend.start()</span><br><span class="line">            sendOne(&quot;chatconfirm&quot;, addr)</span><br><span class="line">    elif message == &quot;3&quot;:</span><br><span class="line">        sendOne(&quot;transferconfirm&quot;, addr)</span><br><span class="line">        datapath = Pipe[addr].get()</span><br><span class="line">        getfire(datapath, addr)  # 调用获取文件函数</span><br><span class="line">        print(&quot;文件传输完成&quot;)</span><br><span class="line">    elif message == &quot;4&quot;:</span><br><span class="line">        sendOne(&quot;\n本程序是我的计算机网络小学期作业\n@author: 朱安杰 194020215&quot;, addr)</span><br><span class="line">    else:</span><br><span class="line">        sendOne(&quot;未知命令：&quot; + message, addr)</span><br><span class="line">def diviceConnect(addr):</span><br><span class="line">    global OCCUIPED</span><br><span class="line">    while state[addr]:</span><br><span class="line">        msg = Pipe[addr].get()</span><br><span class="line">        if OCCUIPED == str(addr):</span><br><span class="line">            if msg == &quot;exitchat&quot;:</span><br><span class="line">                OCCUIPED = &quot;&quot;</span><br><span class="line">                print(&quot;结束聊天&quot;)</span><br><span class="line">                continue</span><br><span class="line">            print(str(addr) + &quot;:&quot; + msg)</span><br><span class="line">            continue</span><br><span class="line">        mafun(msg, addr)</span><br><span class="line"># 接受消息 持续监听6000端口 二级子进程（父进程：主进程（用户进程）；子进程：各个用户设备处理信息对应的进程）</span><br><span class="line"># 接收到的消息分为两类：1.指令形消息2.内容形消息</span><br><span class="line"># 指令形式消息：根据接受到的消息和判断已经存在的设备列表分配（删除）独立进程</span><br><span class="line"># 内容形消息：根据套接字将消息发送给对应的进程（唤醒进程）</span><br><span class="line">def receive():</span><br><span class="line">    while True:</span><br><span class="line">        data, addr = s.recvfrom(BUFFER_SIZE)  # 获取消息</span><br><span class="line">        print(&quot;终端： %s:%s 数据： &quot; % addr + str(data))  # 打印获取信息</span><br><span class="line">        if data == b&quot;tryconnect&quot;:  # 对信息进行分类处理</span><br><span class="line">            ConnectedDivice.append(addr)</span><br><span class="line">            print(&quot;设备：&quot; + str(addr) + &quot; 已被发现！&quot;)</span><br><span class="line">            state[addr] = True</span><br><span class="line">            q = queue.Queue()  # 创建通信管道</span><br><span class="line">            Pipe[addr] = q  # 管道存入字典</span><br><span class="line">            tcreate = threading.Thread(target=diviceConnect, args=(addr,))  # 发现设备后创建分配进程给设备</span><br><span class="line">            tcreate.start()</span><br><span class="line">            # 创建完成后返回连接成功确认</span><br><span class="line">            s.sendto(b&quot;connectconfirm&quot;, addr)</span><br><span class="line">            s.sendto(&quot;输入help获取选项列表&quot;.encode(), addr)</span><br><span class="line">        elif data == b&quot;exit&quot;:</span><br><span class="line">            s.sendto(b&quot;exitconfirm&quot;, addr)</span><br><span class="line">            s.sendto(b&quot;over&quot;, addr)</span><br><span class="line">        elif data == b&quot;overconfirm&quot;:</span><br><span class="line">            print(&quot;设备：&quot; + str(addr) + &quot; 已主动离线！&quot;)</span><br><span class="line">            del state[addr]  # 删除字典</span><br><span class="line">            ConnectedDivice.remove(addr)  # 删除设备列表</span><br><span class="line">        else:</span><br><span class="line">            Pipe[addr].put(data.decode())</span><br></pre></td></tr></table></figure>

<h3 id="客户端程序"><a href="#客户端程序" class="headerlink" title="客户端程序"></a>客户端程序</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"># 获取文件路径，名称</span><br><span class="line"># 变量(文件名)</span><br><span class="line">def getFile(filename):</span><br><span class="line">    filepath, tempfilename = os.path.split(filename)</span><br><span class="line">    shotname, extension = os.path.splitext(tempfilename)</span><br><span class="line">    return filepath, shotname, extension</span><br><span class="line"># 接受消息 持续监听端口 二级子进程（父进程：主进程（用户进程））</span><br><span class="line">def receive():</span><br><span class="line">    global go</span><br><span class="line">    while True:</span><br><span class="line">        if go:</span><br><span class="line">            break</span><br><span class="line">        response, addred = s.recvfrom(1024 * 1024)</span><br><span class="line">        if response == b&quot;exitconfirm&quot;:</span><br><span class="line">            responsee, addrede = s.recvfrom(1024 * 1024)</span><br><span class="line">            if responsee == b&quot;over&quot;:</span><br><span class="line">                s.sendto(&quot;overconfirm&quot;.encode(), addr)</span><br><span class="line">                print(&quot;--------断开服务器：%s:%s--------&quot; % addr)</span><br><span class="line">                s.close()</span><br><span class="line">                go = True</span><br><span class="line">                break</span><br><span class="line">        elif response == b&quot;chatconfirm&quot;:</span><br><span class="line">            continue</span><br><span class="line">        elif response == b&quot;transferconfirm&quot;:</span><br><span class="line">            print(&quot;--------文 件 传 输--------&quot;)</span><br><span class="line">            getfirename = input(&#x27;请输入想要获取的文件:&#x27;)</span><br><span class="line">            dst = input(&#x27;请输入用来保存文件的目标位置:&#x27;)</span><br><span class="line">            s.sendto(getfirename.encode(), addr)</span><br><span class="line">            BUFFER_SIZE = 1024 * 1024</span><br><span class="line">            # 用来临时保存数据</span><br><span class="line">            data = set()</span><br><span class="line">            # 接收数据的Socket</span><br><span class="line">            sock_recv = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</span><br><span class="line">            sock_recv.bind((IP, 7777))</span><br><span class="line">            # 确认反馈地址</span><br><span class="line">            ack_address = (IP, 7778)</span><br><span class="line">            sock_ack = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</span><br><span class="line">            # 重复收包次数</span><br><span class="line">            repeat = 1</span><br><span class="line">            while True:</span><br><span class="line">                buffer, _ = sock_recv.recvfrom(BUFFER_SIZE)</span><br><span class="line">                # 全部接收完成,获取文件名</span><br><span class="line">                if buffer.startswith(b&#x27;over_&#x27;):</span><br><span class="line">                    fn = buffer[5:].decode()</span><br><span class="line">                    # 多确认几次文件传输结束,防止发送方丢包收不到确认</span><br><span class="line">                    for i in range(5):</span><br><span class="line">                        sock_ack.sendto(fn.encode() + b&#x27;_ack&#x27;, ack_address)</span><br><span class="line">                    break</span><br><span class="line">                # 接收带编号的文件数据,临时保存,发送确认信息</span><br><span class="line">                buffer = tuple(buffer.split(b&#x27;_&#x27;, maxsplit=1))</span><br><span class="line">                if buffer in data:</span><br><span class="line">                    repeat = repeat + 1</span><br><span class="line">                else:</span><br><span class="line">                    data.add(buffer)</span><br><span class="line">                sock_ack.sendto(buffer[0] + b&#x27;_ack&#x27;, ack_address)</span><br><span class="line">            sock_recv.close()</span><br><span class="line">            sock_ack.close()</span><br><span class="line">            print(f&#x27;重复接收数据&#123;repeat&#125;次&#x27;)</span><br><span class="line">            data = sorted(data, key=lambda item: int(item[0]))</span><br><span class="line">            with open(rf&#x27;&#123;dst&#125;/&#123;fn&#125;&#x27;, &#x27;wb&#x27;) as fp:</span><br><span class="line">                for item in data:</span><br><span class="line">                    fp.write(item[1])</span><br><span class="line">            print(&quot;传输完成&quot;)</span><br><span class="line">            q.put(1)</span><br><span class="line">        else:</span><br><span class="line">            print(&quot;%s:%s：&quot; % addr + str(response.decode()))</span><br><span class="line"># 发送消息</span><br><span class="line">def circlesend():</span><br><span class="line">    while True:</span><br><span class="line">        send_data = input()</span><br><span class="line">        s.sendto(send_data.encode(), addr)</span><br><span class="line">        if send_data == &quot;3&quot;:</span><br><span class="line">            q.get()</span><br><span class="line">        if go:</span><br><span class="line">            break</span><br></pre></td></tr></table></figure>

<h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p>打开服务器和客户端后执行不同功能如图</p>
<p><img src="http://blog.zhuanjie.ltd/wp-content/uploads/2021/12/image-5.png"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="https://zhuanjier.github.io/blog/2021/11/28/python/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="转接">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="转接的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2021/11/28/python/" class="post-title-link" itemprop="url">Python大作业——北印导航系统</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Veröffentlicht am</span>

              <time title="Erstellt: 2021-11-28 19:03:17" itemprop="dateCreated datePublished" datetime="2021-11-28T19:03:17+08:00">2021-11-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Bearbeitet am</span>
                <time title="Geändert am: 2022-07-10 14:37:47" itemprop="dateModified" datetime="2022-07-10T14:37:47+08:00">2022-07-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">in</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">算法</span></a>
                </span>
                  . 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <hr>
<p>项目成品下载</p>
<p><a target="_blank" rel="noopener" href="http://startpage.zhuanjie.ltd/download/bigcmap.exe">链接1（直接下载）</a></p>
<p><a target="_blank" rel="noopener" href="http://gitlab.zhuanjie.ltd/Randall/bigc-map/-/releases">链接2（发布 · Randall Chu &#x2F; 北印校园导航 · GitLab</a><a target="_blank" rel="noopener" href="http://gitlab.zhuanjie.ltd/Randall/bigc-map/-/releases">)</a></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>针对新生对校园了解的不足，帮助新生对校园中的各建筑有更加多方面的了解。同时可以对于校园工作人员优化校园工具的搬运选择最优的运输路径，提高运输的效率。通过对dijkstra算法进行编写，实现从一个顶点到其余各顶点的最短路径算法，解决的有向图中最短路径问题。主要特点是以起始点为中心向外层层扩展，直到扩展到终点为止，是一种广度优先的搜索方法。</p>
<p>程序的数据和地图利用json.dumps方法编码为json文件的方式放在云服务器上，在运行代码的时候利用json.load方法访问服务器端数据。</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import json</span><br><span class="line">import tkinter</span><br><span class="line">import turtle</span><br><span class="line">import urllib</span><br><span class="line">import urllib.request</span><br><span class="line">from collections import defaultdict</span><br><span class="line">from heapq import heappop, heappush</span><br><span class="line">from math import sqrt</span><br><span class="line">from tkinter import *</span><br><span class="line">from tkinter.ttk import Combobox</span><br><span class="line">from urllib.request import urlretrieve</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 从点str1移动到str2</span><br><span class="line">def move(str1, str2):</span><br><span class="line">    x = point[str1][0] - 953 / 2</span><br><span class="line">    y = 759 / 2 - point[str1][1]</span><br><span class="line">    a = point[str2][0] - 953 / 2</span><br><span class="line">    b = 759 / 2 - point[str2][1]</span><br><span class="line">    turtle.up()</span><br><span class="line">    turtle.goto(x, y)</span><br><span class="line">    turtle.down()</span><br><span class="line">    turtle.goto(a, b)</span><br><span class="line">    turtle.up()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 判断两点的距离</span><br><span class="line">def distence(str1, str2, paramein, pointin):</span><br><span class="line">    if [str1, str2] in paramein or [str2, str1] in paramein:</span><br><span class="line">        return sqrt((pointin[str1][1] - pointin[str2][1]) ** 2 + (pointin[str1][0] - pointin[str2][0]) ** 2)</span><br><span class="line">    elif pointin[str1][0] == pointin[str2][0]:</span><br><span class="line">        return abs(pointin[str1][1] - pointin[str2][1])</span><br><span class="line">    elif pointin[str1][1] == pointin[str2][1]:</span><br><span class="line">        return abs(pointin[str1][0] - pointin[str2][0])</span><br><span class="line">    else:</span><br><span class="line">        return 1E100</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 优化后Dijkstra算法</span><br><span class="line">def dijkstra(edges, t, f):</span><br><span class="line">    g = defaultdict(list)</span><br><span class="line">    for l, r, c in edges:</span><br><span class="line">        g[l].append((c, r))</span><br><span class="line">    q, seen, mins = [(0, f, [])], set(), &#123;f: 0&#125;</span><br><span class="line">    while q:</span><br><span class="line">        (cost, v1, path) = heappop(q)</span><br><span class="line">        if v1 not in seen:</span><br><span class="line">            seen.add(v1)</span><br><span class="line">            path = [v1] + path</span><br><span class="line">            if v1 == t:</span><br><span class="line">                return cost, path</span><br><span class="line">            for c, v2 in g.get(v1, ()):</span><br><span class="line">                if v2 in seen:</span><br><span class="line">                    continue</span><br><span class="line">                prev = mins.get(v2, None)</span><br><span class="line">                next = cost + c</span><br><span class="line">                if prev is None or next &lt; prev:</span><br><span class="line">                    mins[v2] = next</span><br><span class="line">                    heappush(q, (next, v2, path))</span><br><span class="line">    return float(&quot;inf&quot;), []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def draw(value):</span><br><span class="line">    # 初始化地图</span><br><span class="line">    turtle.setup(width=953, height=759, startx=50, starty=30)</span><br><span class="line">    turtle.clear()</span><br><span class="line">    turtle.title(&quot;导航路线&quot;)</span><br><span class="line">    # 图片URL</span><br><span class="line">    url = &#x27;http://startpage.zhuanjie.ltd/json/bigc.png&#x27;</span><br><span class="line">    filename = os.path.basename(url)</span><br><span class="line">    # 判断文件是否存在，如果不存在则下载</span><br><span class="line">    if not os.path.isfile(os.path.join(&quot;./&quot;, filename)):</span><br><span class="line">        try:</span><br><span class="line">            print(&quot;地图下载中：&quot;)</span><br><span class="line">            urlretrieve(url, &#x27;./bigc.png&#x27;, schedule)</span><br><span class="line">        except os.error.HTTPError as e:</span><br><span class="line">            print(e)</span><br><span class="line">            print(&#x27;\n&#x27; + url + &#x27;下载失败！&#x27; + &#x27;\n&#x27;)</span><br><span class="line">            tkinter.messagebox.showinfo(&#x27;提示&#x27;, &#x27;下载地图失败，请重试！&#x27;)</span><br><span class="line">        else:</span><br><span class="line">            print(&quot;\n地图下载完成！&quot;)</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;地图已经存在！&quot;)</span><br><span class="line">    turtle.bgpic(&quot;bigc.png&quot;)</span><br><span class="line">    turtle.pensize(15)</span><br><span class="line">    turtle.color(&quot;#ff0000&quot;)</span><br><span class="line">    turtle.hideturtle()</span><br><span class="line">    for i in range(len(value[1]) - 1):</span><br><span class="line">        move(value[1][i], value[1][i + 1])</span><br><span class="line">    turtle.mainloop()</span><br><span class="line">    # turtle.bye()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 进度条迭代</span><br><span class="line">def progressbar(cur, total=100):</span><br><span class="line">    percent = &#x27;&#123;:.2%&#125;&#x27;.format(cur / total)</span><br><span class="line">    sys.stdout.write(&#x27;\r&#x27;)</span><br><span class="line">    sys.stdout.write(&quot;[%-100s] %s&quot; % (&#x27;=&#x27; * int(cur), percent))</span><br><span class="line">    sys.stdout.flush()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 进度条</span><br><span class="line">def schedule(blocknum, blocksize, totalsize):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    blocknum:当前已经下载的块</span><br><span class="line">    blocksize:每次传输的块大小</span><br><span class="line">    totalsize:网页文件总大小</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    if totalsize == 0:</span><br><span class="line">        percent = 0</span><br><span class="line">    else:</span><br><span class="line">        percent = blocknum * blocksize / totalsize</span><br><span class="line">    if percent &gt; 1.0:</span><br><span class="line">        percent = 1.0</span><br><span class="line">    percent = percent * 100</span><br><span class="line">    progressbar(percent)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 初始化</span><br><span class="line">def init():</span><br><span class="line">    # 特殊连线点</span><br><span class="line">    parame = get_record(&#x27;http://startpage.zhuanjie.ltd/json/parame.json&#x27;)</span><br><span class="line">    # 各个点在地图上的坐标</span><br><span class="line">    pointin = get_record(&#x27;http://startpage.zhuanjie.ltd/json/point.json&#x27;)</span><br><span class="line">    # 复选框的值</span><br><span class="line">    valuesin = get_record(&#x27;http://startpage.zhuanjie.ltd/json/values.json&#x27;)</span><br><span class="line">    # 根据两点距离将相邻的两个点存入matrix</span><br><span class="line">    matrix = []</span><br><span class="line">    for i in pointin:</span><br><span class="line">        for j in pointin:</span><br><span class="line">            if distence(i, j, parame, pointin) != 0 and distence(i, j, parame, pointin) != 1E100:</span><br><span class="line">                matrix.append((i, j, distence(i, j, parame, pointin)))</span><br><span class="line">    return pointin, valuesin, matrix</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 点击按钮运行部分</span><br><span class="line">def calc(a, b):</span><br><span class="line">    x = dijkstra(listview, a, b)</span><br><span class="line">    print(x)</span><br><span class="line">    try:</span><br><span class="line">        draw(x)</span><br><span class="line">    except turtle.Terminator:</span><br><span class="line">        draw(x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 将json文件转化为变量</span><br><span class="line">def get_record(url):</span><br><span class="line">    resp = urllib.request.urlopen(url)</span><br><span class="line">    ele_json = json.loads(resp.read())</span><br><span class="line">    return ele_json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(&quot;开始初始化&quot;)</span><br><span class="line">point, values, listview = init()</span><br><span class="line">root = Tk()</span><br><span class="line">root.title(&#x27;北京印刷学院导航系统&#x27;)</span><br><span class="line">root.geometry(&#x27;320x50&#x27;)</span><br><span class="line">var1 = StringVar()</span><br><span class="line">var2 = StringVar()</span><br><span class="line">comb1 = Combobox(root, textvariable=var1, values=values, state=&#x27;readonly&#x27;)</span><br><span class="line">comb2 = Combobox(root, textvariable=var2, values=values, state=&#x27;readonly&#x27;)</span><br><span class="line">comb1.place(relx=0.1, rely=0.25, relwidth=0.2)</span><br><span class="line">comb2.place(relx=0.4, rely=0.25, relwidth=0.2)</span><br><span class="line">btn = Button(root, text=&quot;导航&quot;, command=lambda: calc(comb1.get(), comb2.get()))</span><br><span class="line">btn.place(relx=0.7, rely=0.25, relwidth=0.2)</span><br><span class="line">root.mainloop()</span><br></pre></td></tr></table></figure>

<h2 id="项目截图"><a href="#项目截图" class="headerlink" title="项目截图"></a>项目截图</h2><p><img src="http://blog.zhuanjie.ltd/wp-content/uploads/2021/11/image.png"></p>
<p><img src="http://blog.zhuanjie.ltd/wp-content/uploads/2021/11/image-1.png"></p>
<p>地图</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="https://zhuanjier.github.io/blog/2021/11/12/python-tqdm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="转接">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="转接的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2021/11/12/python-tqdm/" class="post-title-link" itemprop="url">Python tqdm进度条</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Veröffentlicht am</span>

              <time title="Erstellt: 2021-11-12 18:20:05" itemprop="dateCreated datePublished" datetime="2021-11-12T18:20:05+08:00">2021-11-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Bearbeitet am</span>
                <time title="Geändert am: 2022-07-10 14:37:47" itemprop="dateModified" datetime="2022-07-10T14:37:47+08:00">2022-07-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">in</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="tqdm包"><a href="#tqdm包" class="headerlink" title="tqdm包"></a>tqdm包</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from tqdm import tqdm</span><br></pre></td></tr></table></figure>

<h2 id="创建tqdm"><a href="#创建tqdm" class="headerlink" title="创建tqdm"></a>创建tqdm</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pbar = tqdm(range(1000))  # 创建进度条</span><br><span class="line">for i in pbar:  # 在进度条中运行</span><br><span class="line">    continue</span><br></pre></td></tr></table></figure>

<h2 id="参数解释"><a href="#参数解释" class="headerlink" title="参数解释"></a>参数解释</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">iterable=None,     可迭代的对象, 在手动更新时不需要进行设置</span><br><span class="line">desc=None,      传入str类型，作为进度条标题（类似于说明）</span><br><span class="line">total=None,     预期的迭代次数（即进度条100的时候迭代的次数）</span><br><span class="line">leave=True,     bool值, 迭代完成后是否保留进度条</span><br><span class="line">file=None,      输出指向位置, 默认是终端, 一般不需要设置</span><br><span class="line">ncols=None,     调整进度条宽度, 默认是根据环境自动调节长度, 如果设置为0, 就没有进度条, 只有输出的信息</span><br><span class="line">mininterval=0.1,    最小的更新间隔</span><br><span class="line">maxinterval=10.0,   最大更新间隔</span><br><span class="line">miniters=None, </span><br><span class="line">ascii=None, </span><br><span class="line">unit=&#x27;it&#x27;,    描述处理项目的文字, 默认是&#x27;it&#x27;, 例如: 100 it/s, 处理照片的话设置为&#x27;img&#x27; ,则为 100 img/s</span><br><span class="line">unit_scale=False,    自动根据国际标准进行项目处理速度单位的换算, 例如 100000 it/s &gt;&gt; 100k it/s</span><br><span class="line">dynamic_ncols=False, </span><br><span class="line">smoothing=0.3,</span><br><span class="line">bar_format=None, </span><br><span class="line">initial=0, </span><br><span class="line">position=None, </span><br><span class="line">postfix=dict             以字典形式传入详细信息</span><br></pre></td></tr></table></figure>

<h2 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a>示例代码</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">from time import sleep</span><br><span class="line">from tqdm import tqdm</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for i in tqdm(range(1000)):</span><br><span class="line">    sleep(0.01)</span><br><span class="line">    # print(i)</span><br><span class="line"></span><br><span class="line">pbar = tqdm(range(1000))  # 进度条</span><br><span class="line">for i in pbar:</span><br><span class="line">    err = &#x27;abc&#x27;</span><br><span class="line">    pbar.set_description(&quot;Reconstruction loss: %s&quot; % err)</span><br><span class="line"></span><br><span class="line">dict1 = &#123;&quot;a&quot;: 123, &quot;b&quot;: 456&#125;</span><br><span class="line">for i in tqdm(range(1000), total=1000, desc=&quot;进度条&quot;, ncols=100, postfix=dict1, mininterval=0.3):</span><br><span class="line">    sleep(0.01)</span><br><span class="line"></span><br><span class="line">with tqdm(total=21, desc=&#x27;Example&#x27;, leave=True, ncols=100, unit=&#x27;B&#x27;, unit_scale=True) as pbar1:</span><br><span class="line">    for i in range(7):</span><br><span class="line">        sleep(0.5)  # 发呆0.5秒</span><br><span class="line">        pbar1.update(3)  # 更新发呆进度，每次更新3个迭代次数</span><br></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\zhuan\PycharmProjects\test\venv\Scripts\python.exe C:/Users/zhuan/PycharmProjects/test/进度条.py</span><br><span class="line">100%██████████ 1000/1000 [00:15&lt;00:00, 63.72it/s]</span><br><span class="line">Reconstruction loss: abc: 100%██████████ 1000/1000 [00:00&lt;00:00, 3422.53it/s]</span><br><span class="line">进度条: 100%█████████████████████████████████████ 1000/1000 [00:15&lt;00:00, 63.53it/s, a=123, b=456]</span><br><span class="line">Example: 100%████████████████████████████████████████████████████ 21.0/21.0 [00:03&lt;00:00, 5.89B/s]</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="https://zhuanjier.github.io/blog/2021/11/11/linux-c-communcation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="转接">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="转接的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2021/11/11/linux-c-communcation/" class="post-title-link" itemprop="url">Linux下C语言进程间通信——创建共享区</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Veröffentlicht am</span>

              <time title="Erstellt: 2021-11-11 23:49:19" itemprop="dateCreated datePublished" datetime="2021-11-11T23:49:19+08:00">2021-11-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Bearbeitet am</span>
                <time title="Geändert am: 2022-07-10 14:37:47" itemprop="dateModified" datetime="2022-07-10T14:37:47+08:00">2022-07-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">in</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/C/" itemprop="url" rel="index"><span itemprop="name">C</span></a>
                </span>
                  . 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
                </span>
                  . 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" itemprop="url" rel="index"><span itemprop="name">操作系统</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>与信号量一样，在Linux中也提供了一组函数接口用于使用共享内存，而且使用共享共存的接口还与信号量的非常相似，而且比使用信号量的接口来得简单。它们声明在头文件 sys&#x2F;shm.h 中。</p>
<h2 id="shmget-函数"><a href="#shmget-函数" class="headerlink" title="shmget()函数"></a><strong>shmget()函数</strong></h2><p>int shmget(key_t key, size_t size, int shmflg);</p>
<p>第一个参数为共享内存段命名，需要提供一个参数key（非0整数），shmget()函数成功时返回一个与key相关的共享内存标识符（非负整数），用于后续的共享内存函数。调用<strong>失败返回-1</strong>。设置<strong>参数为IPC_PRIVATE时，每次都创建新的共享区</strong>，通常在父进程创建，子进程获取共享区内容。参数为数值时候，会创建固定共享区。</p>
<p>第二个参数，size以字节为单位指定需要共享的内存容量</p>
<p>第三个参数，shmflg是权限标志，它的作用与open函数的mode参数一样，如果要想在key标识的共享内存不存在时，创建它的话，可以与IPC_CREAT做或操作。共享内存的权限标志与文件的读写权限一样，举例来说，0644,它表示允许一个进程创建的共享内存被内存创建者所拥有的进程向共享内存读取和写入数据，同时其他用户创建的进程只能读取共享内存。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-rw------- (600)    只有拥有者有读写权限。</span><br><span class="line">-rw-r--r-- (644)    只有拥有者有读写权限；而属组用户和其他用户只有读权限。</span><br><span class="line">-rwx------ (700)    只有拥有者有读、写、执行权限。</span><br><span class="line">-rwxr-xr-x (755)    拥有者有读、写、执行权限；而属组用户和其他用户只有读、执行权限。</span><br><span class="line">-rwx--x--x (711)    拥有者有读、写、执行权限；而属组用户和其他用户只有执行权限。</span><br><span class="line">-rw-rw-rw- (666)    所有用户都有文件读、写权限。</span><br><span class="line">-rwxrwxrwx (777)    所有用户都有读、写、执行权限。</span><br></pre></td></tr></table></figure>

<h2 id="shmat-函数-–-at：attach"><a href="#shmat-函数-–-at：attach" class="headerlink" title="shmat()函数    – at：attach"></a><strong>shmat()函数    – at：attach</strong></h2><p>void *shmat(int shm_id, const void *shm_addr, int shmflg);</p>
<p>第一次创建完共享内存时，它还不能被任何进程访问，shmat()函数的作用就是用来启动对该共享内存的访问，并把共享内存连接到当前进程的地址空间。</p>
<p>第一个参数，shm_id是由shmget()函数返回的共享内存标识。</p>
<p>第二个参数，shm_addr指定共享内存连接到当前进程中的地址位置，通常为空，表示让系统来选择共享内存的地址。</p>
<p>第三个参数，shm_flg是一组标志位，通常为0。</p>
<p>调用成功时返回一个指向共享内存第一个字节的指针，如果调用失败返回-1。</p>
<h2 id="shmdt-函数-–-dt：detach"><a href="#shmdt-函数-–-dt：detach" class="headerlink" title="shmdt()函数    – dt：detach"></a><strong>shmdt()函数    – dt：detach</strong></h2><p>int shmdt(const void *shmaddr);</p>
<p>该函数用于将共享内存从当前进程中分离。注意，将共享内存分离并不是删除它，只是使该共享内存对当前进程不再可用。</p>
<p>参数shmaddr是shmat()函数返回的地址指针，调用成功时返回0，失败时返回-1。</p>
<h2 id="shmctl-函数-–-ctl：control"><a href="#shmctl-函数-–-ctl：control" class="headerlink" title="shmctl()函数    – ctl：control"></a><strong>shmctl()函数    – ctl：control</strong></h2><p>int shmctl(int shm_id, int command, struct shmid_ds *buf);</p>
<p>与信号量的semctl()函数一样，用来控制共享内存。</p>
<p>第一个参数，shm_id是shmget()函数返回的共享内存标识符。</p>
<p>第二个参数，command是要采取的操作，它可以取下面的三个值 ：</p>
<ol>
<li>IPC_STAT：把shmid_ds结构中的数据设置为共享内存的当前关联值，即用共享内存的当前关联值覆盖shmid_ds的值。</li>
<li>IPC_SET：如果进程有足够的权限，就把共享内存的当前关联值设置为shmid_ds结构中给出的值</li>
<li>IPC_RMID：删除共享内存段</li>
</ol>
<p>第三个参数，buf是一个结构指针，它指向共享内存模式和访问权限的结构。</p>
<h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><h3 id="题目1：父子进程之间数据交流"><a href="#题目1：父子进程之间数据交流" class="headerlink" title="题目1：父子进程之间数据交流"></a>题目1：父子进程之间数据交流</h3><p>创建子进程输入字符串到共享区，在子进程输入end后进入父进程输出共享区内容</p>
<p>代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;sys/types.h&gt;</span><br><span class="line">#include &lt;sys/shm.h&gt;</span><br><span class="line">#include &lt;sys/wait.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line"></span><br><span class="line">int main()&#123;</span><br><span class="line">    int shmid;</span><br><span class="line">    char *p, *q;</span><br><span class="line">    char buffer[BUFSIZ];</span><br><span class="line">    int pid;</span><br><span class="line">    // 创建共享区</span><br><span class="line">    shmid=shmget(IPC_PRIVATE,128,IPC_CREAT  0666); // 成功创建值&gt;0</span><br><span class="line">    if(shmid &lt;0)&#123; // 创建失败为-1</span><br><span class="line">        printf(&quot;创建共享内存失败\n&quot;);</span><br><span class="line">        return -1;</span><br><span class="line">    &#125;</span><br><span class="line">    printf(&quot;创建共享内存成功 shmid=%d\n&quot;,shmid);</span><br><span class="line">    pid=fork();//创建进程pid</span><br><span class="line">    if(pid==0)&#123;//这是子进程</span><br><span class="line">        // 绑定地址p到共享区</span><br><span class="line">        p=(char *)shmat(shmid,0,0);</span><br><span class="line">        if(p==NULL)&#123;</span><br><span class="line">            printf(&quot;子进程映射失败\n&quot;);</span><br><span class="line">            return -2;</span><br><span class="line">        &#125;</span><br><span class="line">        while(1)&#123;</span><br><span class="line">            printf(&quot;子进程：写入信息：&quot;);</span><br><span class="line">            fgets(buffer,128,stdin);</span><br><span class="line">            strcat(p,buffer); </span><br><span class="line">            if(strncmp(buffer,&quot;end&quot;,3)==0)&#123;</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        shmdt(p);</span><br><span class="line">        exit(0);</span><br><span class="line">    &#125;else if(pid &gt; 0)&#123;// 父进程</span><br><span class="line">        wait(0);</span><br><span class="line">        q=(char *)shmat(shmid,0,0);</span><br><span class="line">        if(q==NULL)&#123;</span><br><span class="line">            printf(&quot;父进程映射失败\n&quot;);</span><br><span class="line">            return -3;</span><br><span class="line">        &#125;</span><br><span class="line">        printf(&quot;父进程：读取数据：\n%s&quot;,q);</span><br><span class="line">        shmdt(q);</span><br><span class="line">    &#125;</span><br><span class="line">    // 删除共享区</span><br><span class="line">    shmctl(shmid,IPC_RMID,NULL);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">randall@ubuntu:~/Desktop/experiment5$ ./E5-3-2.out</span><br><span class="line">创建共享内存成功 shmid=29</span><br><span class="line">子进程：写入信息：1</span><br><span class="line">子进程：写入信息：2</span><br><span class="line">子进程：写入信息：3</span><br><span class="line">子进程：写入信息：randall</span><br><span class="line">子进程：写入信息：end</span><br><span class="line">父进程：读取数据：</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">randall</span><br><span class="line">end</span><br><span class="line">randall@ubuntu:~/Desktop/experiment5$ </span><br></pre></td></tr></table></figure>

<h3 id="题目2：两个程序之间数据交流"><a href="#题目2：两个程序之间数据交流" class="headerlink" title="题目2：两个程序之间数据交流"></a>题目2：两个程序之间数据交流</h3><p>在程序shmsnd.c创建共享区然后输入字符串到共享区，再在shmrcv.c输出共享区内容</p>
<h4 id="代码："><a href="#代码：" class="headerlink" title="代码："></a>代码：</h4><h5 id="shmsnd-c"><a href="#shmsnd-c" class="headerlink" title="shmsnd.c"></a><strong>shmsnd.c</strong></h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;sys/types.h&gt;</span><br><span class="line">#include &lt;sys/shm.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line"></span><br><span class="line">int main()&#123;</span><br><span class="line">    int shmid;</span><br><span class="line">    char *p;</span><br><span class="line">    char buffer[BUFSIZ];</span><br><span class="line">    shmid=shmget(1234,BUFSIZ,IPC_CREAT  0666);</span><br><span class="line">    if(shmid &lt;0)&#123;</span><br><span class="line">        printf(&quot;创建共享内存失败\n&quot;);</span><br><span class="line">        return -1;</span><br><span class="line">    &#125;</span><br><span class="line">    printf(&quot;创建共享内存成功 shmid=%d\n&quot;,shmid);</span><br><span class="line">    p=(char *)shmat(shmid,0,0);</span><br><span class="line">    if(p==NULL)&#123;</span><br><span class="line">        printf(&quot;shmsnd映射失败\n&quot;);</span><br><span class="line">        return -2;</span><br><span class="line">    &#125;</span><br><span class="line">    while(1)&#123;</span><br><span class="line">        printf(&quot;写入信息：&quot;);</span><br><span class="line">        fgets(buffer,BUFSIZ,stdin);</span><br><span class="line">        strcat(p,buffer); </span><br><span class="line">        if(strncmp(buffer,&quot;end&quot;,3)==0)&#123;</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    shmdt(p);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="shmrcv-c"><a href="#shmrcv-c" class="headerlink" title="shmrcv.c"></a>shmrcv.c</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;sys/types.h&gt;</span><br><span class="line">#include &lt;sys/shm.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line"></span><br><span class="line">int main()&#123;</span><br><span class="line">    int shmid;</span><br><span class="line">    char *q;</span><br><span class="line">    shmid=shmget(1234,BUFSIZ,IPC_CREAT  0644);</span><br><span class="line">    if(shmid &lt;0)&#123;</span><br><span class="line">        printf(&quot;创建共享内存失败\n&quot;);</span><br><span class="line">        return -1;</span><br><span class="line">    &#125;</span><br><span class="line">    printf(&quot;创建共享内存成功 shmid=%d\n&quot;,shmid);</span><br><span class="line">    q=(char *)shmat(shmid,NULL,0);</span><br><span class="line">    if(q==NULL)&#123;</span><br><span class="line">        printf(&quot;shmrcv映射失败\n&quot;);</span><br><span class="line">        return -3;</span><br><span class="line">    &#125;</span><br><span class="line">    printf(&quot;读取共享区数据:\n%s&quot;,q);</span><br><span class="line">    shmdt(q);</span><br><span class="line">    shmctl(shmid,IPC_RMID,NULL);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="输出："><a href="#输出：" class="headerlink" title="输出："></a>输出：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">randall@ubuntu:~/Desktop/experiment5$ ./shmsnd.out</span><br><span class="line">写入信息：1 2 3 4 5</span><br><span class="line">写入信息：randall</span><br><span class="line">写入信息：end</span><br><span class="line">randall@ubuntu:~/Desktop/experiment5$ ./shmrcv.out</span><br><span class="line">读取共享区数据:</span><br><span class="line">1 2 3 4 5</span><br><span class="line">randall</span><br><span class="line">end</span><br><span class="line">randall@ubuntu:~/Desktop/experiment5$ </span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="https://zhuanjier.github.io/blog/2021/11/09/python-dict-sort/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="转接">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="转接的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2021/11/09/python-dict-sort/" class="post-title-link" itemprop="url">python中的字典排序</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Veröffentlicht am</span>

              <time title="Erstellt: 2021-11-09 18:54:10" itemprop="dateCreated datePublished" datetime="2021-11-09T18:54:10+08:00">2021-11-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Bearbeitet am</span>
                <time title="Geändert am: 2022-07-10 14:37:47" itemprop="dateModified" datetime="2022-07-10T14:37:47+08:00">2022-07-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">in</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>字典是一个无序的数据结构，一般都不对其进行排序的。但是要想对字典进行排序，是可以通过<code>sorted()</code>函数进行操作。首先声明注意一点字典中的值需要为同一种数据类型；比如在本文中的值都是字符串类型。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"># 先定义一个字典</span><br><span class="line">sys = &#123;&#x27;name&#x27;: &#x27;张三&#x27;,</span><br><span class="line">       &#x27;age&#x27;: &#x27;十八&#x27;,</span><br><span class="line">       &#x27;gender&#x27;: &#x27;男&#x27;&#125;</span><br><span class="line"></span><br><span class="line">#  单独打印出排序后的key值</span><br><span class="line">new_sys = sorted(sys)</span><br><span class="line">print(new_sys)</span><br><span class="line"></span><br><span class="line">new_sys = sorted(sys.keys())</span><br><span class="line">print(new_sys)</span><br><span class="line"></span><br><span class="line"># 根据key的升序排列，把key value都打印出来</span><br><span class="line">new_sys1 = sorted(sys.items(), key=lambda d: d[0], reverse=False)</span><br><span class="line">print(new_sys1)</span><br><span class="line"></span><br><span class="line">new_sys1 = sorted(sys.items(), reverse=False)</span><br><span class="line">print(new_sys1)</span><br><span class="line"></span><br><span class="line"># 单独打印出排序后的value值</span><br><span class="line">new_sys1 = sorted(sys.values())</span><br><span class="line">print(new_sys1)</span><br><span class="line"></span><br><span class="line"># 打印出根据value排序后的键值对的具体值</span><br><span class="line">new_sys2 = sorted(sys.items(),  key=lambda d: d[1], reverse=False)</span><br><span class="line">print(new_sys2)</span><br></pre></td></tr></table></figure>

<p>输出为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[&#x27;age&#x27;, &#x27;gender&#x27;, &#x27;name&#x27;]</span><br><span class="line">[&#x27;age&#x27;, &#x27;gender&#x27;, &#x27;name&#x27;]</span><br><span class="line">[(&#x27;age&#x27;, &#x27;十八&#x27;), (&#x27;gender&#x27;, &#x27;男&#x27;), (&#x27;name&#x27;, &#x27;张三&#x27;)]</span><br><span class="line">[(&#x27;age&#x27;, &#x27;十八&#x27;), (&#x27;gender&#x27;, &#x27;男&#x27;), (&#x27;name&#x27;, &#x27;张三&#x27;)]</span><br><span class="line">[&#x27;man&#x27;, &#x27;十八&#x27;, &#x27;张三&#x27;] </span><br><span class="line">[(&#x27;gender&#x27;, &#x27;man&#x27;), (&#x27;age&#x27;, &#x27;十八&#x27;), (&#x27;name&#x27;, &#x27;张三&#x27;)]</span><br></pre></td></tr></table></figure>

<p><code>new_sys = sorted(sys)</code>将字典直接传入到<code>sorted</code>函数中 ，<code>sorted</code>函数会默认根据字典的键k对字典进行排序，同时只取字典的键k的内容，并以列表的形式返回</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new_sys1 = sorted(sys.items(), key=lambda d: d[0], reverse=False)</span><br></pre></td></tr></table></figure>

<p><code>sys.items()</code>这段代码，在打印输出后，会显示如下结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dict_items([(‘name’, ‘张三’), (‘age’, ‘十八’), (‘gender’, ‘man’)])</span><br><span class="line"></span><br><span class="line">// 将原来的字典中的键值对，分别搜存入到一个元组中–&gt;(key,value)</span><br></pre></td></tr></table></figure>

<p><code>key=lambda</code> <code>d: d[0]</code> 是一个匿名函数；<br>其中：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d == (‘name’, ‘张三’) 或 (‘age’, ‘十八’)或(‘gender’, ‘man’)</span><br></pre></td></tr></table></figure>

<p><code>d[0]</code>是获取每个元组中的第一个元素，就是原<code>sys</code>字典中的<code>key</code>；并将匿名函数的返回值返回给<code>sorted</code>函数的key参数</p>
<p><code>reverse=False</code> 排序默认是按照升序排列的，也可以改为<code>True</code></p>
<p><code>sorted(sys.values())</code> <code>sorted</code>函数默认是根据键<code>key</code>排序的，所以想要根据值<code>value</code>排序，就需要在<code>sys</code>后面使用<code>values()</code>，获取字典的<code>value</code>值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">new_sys2 = sorted(sys.items(), key=lambda d: d[1], reverse=False)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d == (‘name’, ‘张三’) 或 (‘age’, ‘十八’)或(‘gender’, ‘man’)</span><br></pre></td></tr></table></figure>

<p><code>d[1]</code>是获取每个元组中的第二个元素，就是原<code>sys</code>字典中的<code>value</code>；并将匿名函数的返回值返回给<code>sorted</code>函数的<code>key</code>参数</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="https://zhuanjier.github.io/blog/2021/11/05/linux-ruanzhongduan-problem/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="转接">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="转接的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2021/11/05/linux-ruanzhongduan-problem/" class="post-title-link" itemprop="url">关于Linux下软中断通信子进程不输出（接收不到信号问题）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Veröffentlicht am</span>

              <time title="Erstellt: 2021-11-05 02:38:09" itemprop="dateCreated datePublished" datetime="2021-11-05T02:38:09+08:00">2021-11-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Bearbeitet am</span>
                <time title="Geändert am: 2022-07-10 14:37:47" itemprop="dateModified" datetime="2022-07-10T14:37:47+08:00">2022-07-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">in</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/C/" itemprop="url" rel="index"><span itemprop="name">C</span></a>
                </span>
                  . 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
                </span>
                  . 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" itemprop="url" rel="index"><span itemprop="name">操作系统</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>软中断通信的一题：</p>
<p>编写程序：用<code>fork( )</code>创建两个子进程，再用系统调用<code>signal( )</code>让父进程捕捉键盘上来的中断信号(即按^c键)；捕捉到中断信号后，父进程用系统调用<code>kill( )</code>向两个子进程发出信号，子进程捕捉到信号后分别输出下列信息后终止：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Child process1 is killed by parent!</span><br><span class="line">Child process2 is killed by parent!</span><br></pre></td></tr></table></figure>

<p>父进程等待两个子进程终止后，输出如下的信息后终止：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Parent process is killed!</span><br></pre></td></tr></table></figure>

<p>编译运行后发现如果不在父进程添加<code>sleep()</code>就会导致子进程无法输出：</p>
<p>我用输出不同数字夹在进程通信的代码周围：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;signal.h&gt;</span><br><span class="line">#include &lt;sys/types.h&gt;</span><br><span class="line">#include &lt;sys/wait.h&gt;</span><br><span class="line"></span><br><span class="line">int flag_signal=1;</span><br><span class="line">void int_func(int sig)&#123;</span><br><span class="line">    flag_signal=0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main ()&#123;</span><br><span class="line">    int pid1 = fork();</span><br><span class="line">    if (pid1 &lt; 0) &#123;</span><br><span class="line">        printf(&quot;Error in fork!&quot;);</span><br><span class="line">    &#125; else if (pid1 == 0) &#123;</span><br><span class="line">        printf(&quot;4\n&quot;);</span><br><span class="line">        signal(SIGUSR1,int_func);</span><br><span class="line">        printf(&quot;5\n&quot;);</span><br><span class="line">        while(flag_signal==1)&#123;sleep(1);&#125;</span><br><span class="line">        printf(&quot;Child progress 1 is killed by parent!\n&quot;);</span><br><span class="line">        exit(0);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        int pid2 = fork();</span><br><span class="line">        if (pid2 &lt; 0) &#123;</span><br><span class="line">            printf(&quot;Error in fork!&quot;);</span><br><span class="line">        &#125; else if (pid2 == 0) &#123;</span><br><span class="line">            printf(&quot;6\n&quot;);</span><br><span class="line">            signal(SIGUSR2,int_func);</span><br><span class="line">            printf(&quot;7\n&quot;);</span><br><span class="line">            while(flag_signal==1)&#123;sleep(1);&#125;</span><br><span class="line">            printf(&quot;Child progress 2 is killed by parent!\n&quot;);</span><br><span class="line">            exit(0);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            sleep(1);</span><br><span class="line">            printf(&quot;1\n&quot;);</span><br><span class="line">            kill(pid1,SIGUSR1);</span><br><span class="line">            printf(&quot;2\n&quot;);</span><br><span class="line">            kill(pid2,SIGUSR2);</span><br><span class="line">            printf(&quot;3\n&quot;);</span><br><span class="line">            wait(0);</span><br><span class="line">            wait(0);</span><br><span class="line">            printf(&quot;Parent progress is killed!\n&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此时输出是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">randall@ubuntu:~/Desktop$ gcc helloword.c</span><br><span class="line">randall@ubuntu:~/Desktop$ ./a.out</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">Child progress 1 is killed by parent!</span><br><span class="line">Child progress 2 is killed by parent!</span><br><span class="line">Parent progress is killed!</span><br><span class="line">randall@ubuntu:~/Desktop$ </span><br></pre></td></tr></table></figure>

<p>去掉<code>sleep(1)</code>;后输出变成了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">randall@ubuntu:~/Desktop$ gcc helloword.c</span><br><span class="line">randall@ubuntu:~/Desktop$ ./a.out</span><br><span class="line">1</span><br><span class="line">4</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">Parent progress is killed!</span><br><span class="line">randall@ubuntu:~/Desktop$ </span><br></pre></td></tr></table></figure>

<p>可以看出没有加<code>sleep()</code>的时候根本没有运行到子进程</p>
<p>原因：没有使主线程<code>sleep</code>会导致主线程优先运行，主线程运行完了kill指令，发送信号给了子线程，但是子线程没有加载到<code>signal</code>命令，把主线程丢给子线程的信号抛弃，最后子线程随着主线程关闭关闭导致不输出子线程的数据。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="https://zhuanjier.github.io/blog/2021/11/02/linux-wait-waitstatus-wifexitedstatus-exit/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="转接">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="转接的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2021/11/02/linux-wait-waitstatus-wifexitedstatus-exit/" class="post-title-link" itemprop="url">Linux下c语言进程通讯——wait()/wait(&status)/WIFEXITED(status)和exit()之间的关系</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Veröffentlicht am</span>

              <time title="Erstellt: 2021-11-02 00:36:25" itemprop="dateCreated datePublished" datetime="2021-11-02T00:36:25+08:00">2021-11-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Bearbeitet am</span>
                <time title="Geändert am: 2022-07-10 14:37:47" itemprop="dateModified" datetime="2022-07-10T14:37:47+08:00">2022-07-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">in</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/C/" itemprop="url" rel="index"><span itemprop="name">C</span></a>
                </span>
                  . 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
                </span>
                  . 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" itemprop="url" rel="index"><span itemprop="name">操作系统</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="wait-函数定义"><a href="#wait-函数定义" class="headerlink" title="wait()函数定义"></a>wait()函数定义</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;sys/types.h&gt; </span><br><span class="line">#include &lt;sys/wait.h&gt;</span><br><span class="line">pid_t wait(int *status)</span><br><span class="line">// 参数status用来保存被收集进程退出时的一些状态，它是一个指向int类型的指针。但如果我们对这个子进程是如何死掉的毫不在意，只想把这个僵尸进程消灭掉，（事实上绝大多数情况下，我们都会这样想），我们就可以设定这个参数为NULL，如pid=wait(NULL)，返回给pid的值就是子进程的id</span><br></pre></td></tr></table></figure>

<h2 id="WIFEXITED-status-x2F-WEXITSTATUS-status"><a href="#WIFEXITED-status-x2F-WEXITSTATUS-status" class="headerlink" title="WIFEXITED(status)&#x2F;WEXITSTATUS(status)"></a>WIFEXITED(status)&#x2F;WEXITSTATUS(status)</h2><p>当子进程正常结束时，WIFEXITED(status) 返回非0值；当子进程异常结束时，WIFEXITED(status) 返回0值</p>
<p>WEXITSTATUS(status)在WIFEXITED(status)为非0时可以用来获取exit()中的参数即返回给父进程的值，如果子进程调用exit(5)退出，WEXITSTATUS(status)就会返回5；如果进程不是正常退出的，也就是说，WIFEXITED返回0</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;sys/types.h&gt;</span><br><span class="line">#include &lt;sys/wait.h&gt;</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    int status;</span><br><span class="line">    pid_t pc,pr;</span><br><span class="line">    pc=fork();</span><br><span class="line">    if(pc&lt;0) </span><br><span class="line">        printf(&quot;error ocurred!\n&quot;);</span><br><span class="line">    else if(pc==0)&#123; </span><br><span class="line">        printf(&quot;This is child process with pid of %d.\n&quot;,getpid());</span><br><span class="line">        exit(5);        </span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;           </span><br><span class="line">        pr=wait(&amp;status);</span><br><span class="line">        if(WIFEXITED(status))&#123;  </span><br><span class="line">            printf(&quot;the child process %d exit normally.\n&quot;,pr);</span><br><span class="line">            printf(&quot;WIFEXITED(status) is %d.\n&quot;,WIFEXITED(status));</span><br><span class="line">            printf(&quot;WEXITSTATUS(status) is %d.\n&quot;,WEXITSTATUS(status));</span><br><span class="line">        &#125;</span><br><span class="line">        else                   </span><br><span class="line">            printf(&quot;the child process %d exit abnormally.\n&quot;,pr);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="http://blog.zhuanjie.ltd/wp-content/uploads/2021/11/%E5%9B%BE%E7%89%87-1.png"></p>
<p>运行后截图</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="https://zhuanjier.github.io/blog/2021/10/22/python-judge-character/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="转接">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="转接的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/blog/2021/10/22/python-judge-character/" class="post-title-link" itemprop="url">Python判断数据类型</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Veröffentlicht am</span>

              <time title="Erstellt: 2021-10-22 23:09:34" itemprop="dateCreated datePublished" datetime="2021-10-22T23:09:34+08:00">2021-10-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Bearbeitet am</span>
                <time title="Geändert am: 2022-07-10 14:37:47" itemprop="dateModified" datetime="2022-07-10T14:37:47+08:00">2022-07-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">in</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>python用与判断数据类型的函数：</p>
<p>isinstance()函数<br>isinstance(变量,类型)<br>isinstance(i, int)<br>可以用来判断变量的类型，它返回的是一个布尔值，False or True.</p>
<p>type()函数<br>不是判断变量的类型，而使直接返回变量的类型</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/blog/page/4/"><i class="fa fa-angle-left" aria-label="Vorherige Seite"></i></a><a class="page-number" href="/blog/">1</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/blog/page/6/">6</a><a class="page-number" href="/blog/page/7/">7</a><a class="extend next" rel="next" href="/blog/page/6/"><i class="fa fa-angle-right" aria-label="Nächste Seite"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Inhaltsverzeichnis
        </li>
        <li class="sidebar-nav-overview">
          Übersicht
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">转接</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/blog/archives/">
        
          <span class="site-state-item-count">68</span>
          <span class="site-state-item-name">Artikel</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">Kategorien</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">转接</span>
</div>
  <div class="powered-by">Erstellt mit  <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/blog/lib/anime.min.js"></script>
  <script src="/blog/lib/velocity/velocity.min.js"></script>
  <script src="/blog/lib/velocity/velocity.ui.min.js"></script>

<script src="/blog/js/utils.js"></script>

<script src="/blog/js/motion.js"></script>


<script src="/blog/js/schemes/muse.js"></script>


<script src="/blog/js/next-boot.js"></script>




  















  

  

</body>
</html>
